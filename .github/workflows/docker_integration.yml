name: docker integration
on: [push]
jobs:
  init-pytest:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: pip install pytest

  docker-pipeline:
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/master'
    steps:
      - uses: actions/checkout@v3
      - run: docker build -t mb_dockerintegration .
      - run: docker tag mb_dockerintegration:latest mbaisset/dockinteg:latest
      - run: docker login -u ${{secrets.DOCKERHUB_LOGIN}} -p ${{secrets.DOCKERHUB_PASSWORD}}
      - run: docker push mbaisset/dockinteg:latest
